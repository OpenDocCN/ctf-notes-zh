# 2024最新版网络安全秋招面试短期突击面试题【100道】我会出手带你一周上岸！（网络安全、渗透测试、web安全、安全运营、内网安全、等保测评、CTF等） - P69：在内网渗透中你如何搭建内网隧道 - CTF入门教学 - BV1bcsTeXEwR

大家好，我是黑客大白。接下来我们一起看一道面试题。那么这道面试题呢，出现在某公司高级渗透工程师的这样一个岗位。那么面试官呢在面试过程中问到，在内网渗透中，平时如何搭建内网隧道。

我们在拿到这样一道面试题的时候，我们首先要判断面试官对我们的考察的一些具体的知识点和项目是什么。那么这道面试题的话呢，实际上是。呃，面试者。考察这个面试者对内网渗透过程中呢。

具体的这个技术的一些相关的运用的一个考察。实际在内网渗透过程中呢，我们会面临很多的问题。那么这样一些问题往往就能体现这个呃渗透测试工程师就是这样一个岗位，攻击者，他具备。

就怎么样的一个随机应变的解决问题的一个能力。在内网测试过程中呢呃最常遇到的问题就是目标的这个机器呢被他这个电脑上所装的这个防护软件，比如说防火墙或者是入侵检测设备，然后限制了一些通信。

那么这个内网通信如果说被限制了。那就导致我们的这个内网渗透呢，没有办法去进行。因此，解决这一类的这个网络通信问题，就是非常关键的。所以说对于高级渗透测试工程师或者红队等等啊。

这类比较高薪的这个岗位人员来讲。内网渗透的这个相关技能，就是这这一些高薪岗位呢任职的必须的必会的一些技能了。好，那么在回答这样一个问题之前呢，我们要先明白一下这个内网隧道啊，它是一个什么样的概念。好。

什么是内网隧道呢？大家可以看到我们这边的啊右边的一个流程图。那么当攻击者在对目标发起这个攻击或者是产生这个通信连接的过程中，如果说在目标主机上部署了一些防火墙或者是入侵检测设备。

那么我们攻击者呢是没有办法直接连接到对方的。那么在这个过程中，我们就需要搭建隧道啊，就比如说我们是使用一个跳板机。然后通过连接这个内网下面的呃这个跳板机呢，在跳板机上面使用一些隧道工具搭建一些隧道。

那么通过连接这个呃跳板机，然后目标主机呢呃也能够连接到这个跳板机，从而呢双方呢之间互相通信呢，就经过这样一个隧道啊，从而可以绕过这个防火墙的一些通信的限制。所以说这个就叫做内网隧道啊。啊。

也就是我们左边的这样一段介绍，当我们在外网呢成功拿到其中这个内网中的一台主机之后，可以通过端口转发或者是内网穿透等等一些方式来进一步的入侵内网。啊，我们取得这个内网机器的时候呢。

可以通过这个隧道来绕过一些防火墙的一些限制。好，我们知道隧道的一些相关概念之后，接下来我们在回答这样一个问题之前呢，呃大白这边会说出一些就是关键词，一些专业术语。那么我们首先来熟悉一下。呃。

这个PTUNNEL这个呢主要是运用在linux系统中的一个内网隧道工具啊。那么这样一款工具的话呢，呃目前来讲是直接可以在这个linux系统。

比如说咱们的卡里或者是深度OS乌班图机器里面直接使用命令去下载。那么跳板机是什么呢？跳板机实际上就是肉机的一种。在内网中呢，主要指这个攻击者控制的一台机器。

我们往往在这个内网隧道这个呃内网渗透的过程中呢，使用这个跳板机作为端口转发和代理，或者是搭建隧道的一个中转站啊，也就是我们刚刚上一个看到的这样一个图片。那么这个LCX呢是一种内网穿透的这个隧道工具啊。

那么这款工具的话呢，大白也是放在了评论区，有需要的小伙伴可以在评论区留言啊，我们一起学习进步。还有这个DNSbe这个东西是什么呢？其实是呃在costrake，也就是我们这个呃红队攻击工具啊。

也就是内网渗透工具。我们简称这个CS。是运行在这个CS上面的一个攻击的模块啊，我们把它叫做这个窃听器。那么这样一个模块的话呢，可以就是呃我们形成一个窃听器以后呢，可以通过它生成一个木马。

然后把这个木马上传到目标主机上，从而达到长期控制它的一个目的。好，那么我们学到了一些专业术语之后，接下来我们一起来看一下呃，这道题目的话，我们如何去做答。好。

当面试官提问这个呃我们平常在内网渗透过程中呢，如何去搭建隧道好，我是这样去回答的。面试官你好，那么在内网渗透过程中呢，搭建隧道前提啊，是有两个前提。首先第一个呢就是先要拿下内网中的一台机器。

也就是我们所说的这个跳板机啊，我们首先得有一个跳板机。然后在这个跳板机上面呢，我们要先进行一些充分的信息收集。比如说收集到对方的这个呃网段的一些信息，网络的一些信息。😊，然后呢。

还有一个条件就是我们必须要知道目标主机的防火墙，它对于哪些协议具有一些限制。那么具体怎么去呃知道它对于哪些协议有什么限制呢，我们可以使用一些命令去进行探测啊。那么具体的命令呢。

我们这个笔记里面也给大家记录了非常的完全。呃，如果说对方使用是。就是去探测对方是否就是对这个TCP鞋进行限制的话，我们可以使用这个net cat啊，也就是我们所说的这个瑞士军刀。

NC这样一个命令去进行探测。然后呢，HTTP协议的话，我们可以使用这个ca命令。啊，如果是这个SMP的话呢，那就比较简单，我们直接使用这个聘命令啊，聘对方的这个IP地址和域名或者是域名就可以了。

如果对方是对于这个呃DNS协议没有进行限制的话，我们也可以使用这个DNS协议啊，去对它进行一个探测，就是使用这个NSlookup啊NSlookup的是这个windows系统中自带的这个DNS探测的命令。

那么这个linux系统呢使用这个第个命令。😊，那么通过上面的几个这个命令呢啊依次在这个跳板机呢去对目标主机呢发起一个连接的过程中，我们就能够判断出目标主机呢，它对于什么样的这个协议呢有一个限制。

当然这个呃如果说他对这个相应的协议有限制的话，我们这些命令肯定是不会产生通信结果的，明白吧？如果说它没有限制。那么比如说他对这个TCP协议没有限制。那么我们使用这个netca命令去探的时候。

对方是会有回显结果的。啊，这个就是可以判断出对方呃对哪些协议呢有一些限制。好，我们知道对方有一些呃对哪些协议没有进行限制了之后，我们接下来就针对这样一些协议呢来去对方呃这个机器上面搭建一些隧道。

从而达到的一个呃探就是能够实现这个网络通信的一个目的。好，首先的话，如果说对方在这个网络层没有对我们的这个呃防火墙进行限制的话呢，那么我们可以通常情况下是使用这个ICMP啊，这样的一个协议。

那么这个协议的话呢，可以使用这样一款工具叫做PTUNNEL这个工具。这个工具的话呢，呃通常是在这个linux系统中去使用的。那么我们常用的攻击机呢是卡里机器。😊，咖利机器上话呢，它是需要安装的啊。

我们就直接使用这样一个命令去进行安装。如果是深通OS7的话呢，那么就使用以下的这呃方式啊，因为它要安装依赖环境。好，那么还这个工具安装好了以后，我们就要在这个攻击机咖利和跳本机上面呢分别建立这个隧道。

首先呢我们需要在这个跳本机上面使用这样一个命令啊，杠X然后后面接上一个参数啊，给它启动一个隧道，把这个隧道开启之后呢，就在攻击机上面，也就是我们的咖利主机上面再使用这个。呃，PTUNEL啊。

然后杠P呢指定这个跳板机的IP地址，然后呢。呃，转发到这个1080的这个端口啊，这样一个命令大家看起来虽然说比较长，但是它这个命令的话是比较简单的，比较好理解。那么这样一个命令实际上是什么意思呢？

就是哦通过这个PTUNNEL这样一个端口这个隧道这个代理的一个工具呢，把目标主机的这个指定的这个22这样一个端口啊，比如说这个22端口把它转发到。这个跳板机的啊指定的这个1080这个端口上面来。

那么转发到这个1080端口之后，我们直接就可以在本机上面物理机上面访问这个呃卡里机器的1080端口。接下来就可以直接呢呃实现一个内网的通信。那么这样一个命这样一个工具，实际上就是。

也就是说这样一款工具的话，实际上就是把目标机器的指定端口的流量，通过ICMP的隧道封装给这个跳板机的这个对应的端口。然后我们直接在本机呢去呃访问这样一个端口，就能够达到一个互相通信的一个目的。好。

这个是网络层的话，我们是通常使用这样一个工具。那么在这个传输层的话呢，我们也有这个相应的工具啊。这一款工具的话呢叫做LCX。啊，这个工具实际上它的原理跟我们的这个呃上一款工具呢是类似的啊。

也是同样的在这个目标机器上面使用我们的LCX呢，把它本机的这个3389的这样一个流量呢转发到对应的这个什么跳板机的指定的端口。比如说我这边呢是给它举例，转发到4个6这样一个端口。那么在跳板机这边呢。

我们要也要使用这个LCX这样的工具呢去接收来自这个呃目标主机呢转发了这4个6的这样一个端呃这个端口的流量。然后同样的再把它转发第二次啊，转发到4个7这样一个端口。然后转发完了之后。

我们直接就可以在攻击机上面通过这个远程连接，连接到这个跳板机IP的这个什么4个7这样一个端口呢，就能够实现对内网的这样一个隧道的一个穿透。好，这是这个呃传输层的这样一个隧道工具。那么在应用层上面呢。

通常我们是使用这个DNS隧道配合这个costr呢来达到一个上线的目的。但是这种方法的话呢，它呃条件比较多。首先我们需要开通一个云服务器，然后搭配相应的域名。在这个云服务器里面呢。

把这个DNS的解析记录呢添加上去，然后再使用这个CS啊，就是我们的这个内网渗透的这样一款工具呢，创建DNSBken，也就是我们的这个监听器。然后使用我们的这个CS对应的就是刚刚生成的这个监定器呢。

再生成一个木马出来，把这个木马上传到目标主机。当目标主机运行我们的木马之后，就可以达到一个上线的目的。那么呃对方上线的话，也就表示我们的这个内网的这个隧道是能够成功搭建的。好。

那么关于呃网络安全的一些常见的面试题呢，大白这边也是给大家进行了一些整理归纳。欢迎有需要的小伙伴呢在评论区留言，我们一起学习进步，谢谢大家。😊。

