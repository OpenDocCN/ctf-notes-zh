# CTF-Web历年考题精讲教程 从入门到精通 - P4：反序列化__wakeup - 黑客入门101 - BV14YtkebEbY

Yeah。我山月啊，今天我们就续给大家讲这些反序列化的，因为反序列化里面的内容特别多啊。那么我们1。1点给大家讲啊给大家讲，因为以前一节课里面讲的太多的，大家也消化不了。

那么我们每个每个点每个点去给大家讲。那么今天继续给大家讲这个反序列法啊，那么用到的它有一个魔术方法叫做。啊，work out对吧？这个唤醒的这个函数。那么这个函数啊它。在什么时候调用啊，对吧？再执行。

假如那里面有这个啊。有这个函数啊，hel后我们经过啊反序列化时才会调用这个函数的。那么这个地方我们用这个例子给大演示一下啊，这里只是一个很简单的这个实例啊。



![](img/ea3534616268f3d9d55059a31988b627_1.png)

那么我们打开打开CE好，给大家分析一下啊。那这里面有个有个类啊，类里面有两两个私有方法，对吧？两个实有方法，里面有个私有方法，传递枝的话一般都是用我们这种。嗯，高价函数啊，用哪些高价函数N那8。

在类似句块的时候，在这里传有些值，然后这里的话就获取到这个值了，这个值的话就就可以在类里面调用了。那么。在这里还有1个F一方法，F一方法的话就输做S1的。然后这里有个we。这里有个函数。

这个函数的话就是调这里面的函数。就是说我们在类在16块的时候，这里类在16块的时候呢，他会首先去调用这个函数，调用这个函数。点这个函数啊。你弄的插去再去调用这个公共的。翻法啊咁嗰度即个翻法然后呢。

你弄呢再实力化再实力化。再去洗列款，然后执行这里面的操作。那么这里有个C这里有个序列块，这里有个序列块，然那我们把数数列序列块然后输入出来。然后这边的话呢再有一个反序列，就是说我们首先这一这里的话。

首先呢你要做的。这个类16化之后啊，16块之后，它这边的话呢才会来到这里来。来到这里来，然后呢，它这里会输出呃16化序列化之后的。这些字不串啊，很多呢我们把它说出来，你弄呢它。这边的话呢我们先不传值。

按照这边我们先。先让它做试掉然弄呢我们先来看下面这一段。嗯。那么这边的话呢，我们在这里加个端点就可以了。呃，在这里下个端点。这里的话我们看看。



![](img/ea3534616268f3d9d55059a31988b627_3.png)

啊，这边已经在监清了然后呢我们访问看一看。

![](img/ea3534616268f3d9d55059a31988b627_5.png)

好。CD f。Demo。等们湖牌城市。这里是C。好，我们先这样来访问啊。这边的话抓到断点了，嗯让他走。对吧首先这边的话它会实6化了，实6化之后呢，我们传进传入值，传进123，还有get。那么我们看一下。

这里的话就有了啊。就有了这个里面的。啊，这里面的这个123还有get，我们让他走再走一走，对吧？那这里的话就有了啊，123。123对吧？这里的。哦，这里的方法应该是个。一种方法。



![](img/ea3534616268f3d9d55059a31988b627_7.png)

这里面嘛改一下。

![](img/ea3534616268f3d9d55059a31988b627_9.png)

好了。那么我们再来试一下啊。好，让他直直接的来。好，走到这里了，123get然后这边的话就会获取到123这里的话就get，对吧？好，这里的直接变上啊。好，这里的值也变了。get。好了。

那这边的话就类在1列化，15号完之后呢，我们看一下这里的函数，就是把它序列化。我们看一下。它是6化之后出来的值，我们可以在这里边看一下。对吧。嗯。好了，我们继续让他。好，这里的话就没了啊。

这里的话就没了。那么现在呢我们。把值设出来啊。

![](img/ea3534616268f3d9d55059a31988b627_11.png)

这边这里应该是有值的，我们看一下，这里的话就是我们的46化之后的值，对吧？好，大家看到这里的话是好像是有你扣的。



![](img/ea3534616268f3d9d55059a31988b627_13.png)

好了。那现在的话呢，我们。

![](img/ea3534616268f3d9d55059a31988b627_15.png)

我们把这纸拿过来啊，然后让它返序列块。

![](img/ea3534616268f3d9d55059a31988b627_17.png)

吓。好了，那这里反射列块的话，我们不需要长用纸了。然后在这边的话，我们把这个拿回来就可以了。好，这边的话我们再抓一下。你 know呢我们。😔。



![](img/ea3534616268f3d9d55059a31988b627_19.png)

在这里在这里消后端点。让他来执行。

![](img/ea3534616268f3d9d55059a31988b627_21.png)

好。吓。好了，这边的话已经执成完毕了。我们这边的话再返序列化，我们看一下。对吧这边的话已经在反序列块了。还是6块之后啊。反射列化之后，我们首先的话它会调用这个函数，这个函数一定要用的话就输出这这里面的。

好，我们看一下好，对吧？他现在的话来到这里了，然后让他走一走。这里的话就输出F1。好，完了没了，对吧？那这个的话就是这个racking after这个函数的使用啊。我们在反序列化的时候呢。

它首先地点的话仓位去调用这个函数。

![](img/ea3534616268f3d9d55059a31988b627_23.png)

吓。我们继续来看一下。

![](img/ea3534616268f3d9d55059a31988b627_25.png)

好走走走走。对吧。插手先的话会调这卡鼠钟，这边的话调用插类插的这个类里面的方法F一方法。

![](img/ea3534616268f3d9d55059a31988b627_27.png)

好了，这里是是F1。好了，那么这里看完之后呢，我们来看一下它的这个题目，这个题目呢。

![](img/ea3534616268f3d9d55059a31988b627_29.png)

就啊。查要读取flag点PGP里面的内容，就是这里面的内容啊。

![](img/ea3534616268f3d9d55059a31988b627_31.png)

就这里面的内容，那么我们直接访问的话是访问不到的。

![](img/ea3534616268f3d9d55059a31988b627_33.png)

啊，H点PHP好了，对吧？是没有没有东西的。那我那么我们要通过这一段代码来读读取一下这里面的内容，对吧？啊，这里面也是有了啊。



![](img/ea3534616268f3d9d55059a31988b627_35.png)

好。我们看一下这道题。好，大家看一下，这里有个ge有个G。这里也就不算A，对吧？咱就直过来之后呢，它这边的话是用这个bease64抵扣的。将他抵扣啊自己。这里的话一定是一个beta64位的对的。

beta64N到这边的话会解码，解码完之后呢，超位去。啊，传到一个反序列化函数里面，反数列化函数里面插第一插第一第二的话，肯定这个是这个函数，这个函数要做什么便利啊，便历里面的内容，要便历里面的内容。

然后把。然后呢假如它这里有值有值的情况下，有值的情况下，它会把这个值用ADD哎，这个函数就过滤一些特殊字符啊，然后呢把红格也过滤掉。然后呢这边的话，它还会调用函数，调用上面这个函数啊，然后把空格转为空。

把空格转为空啊，这里是空格转为空，然后返回字录端给给到这里啊。给到这里之后呢。查。这要去什么呢？给到这里之后才要去这个。诶。给到这边的话，他。这边。这边的话他要做什么？他要传递这个。诶。值了对吧？

这里有个叫方法，就是在16块的时候，这里的话会弹入值。弹入值之后呢，很多结束掉之后啊，这这个呃内在结束之后呢，超微调用这个ci扣方法，然后调用里面的。教你们的方法。

就这里的话就判断它数组里面是否有拼的啊，有拼台可以有拼的话呢，他会去调用这个co rule的发 agree。这里的话是一个啊是一个调用。方法的一个数组啊的一个函数。这个函数的话。

这边呢这边的话是调用这个方法的，调用哪个方法哈，对吧？这样是这个方法。拼的方法，后这里面传就值。好，这边的话两边的话都需要一个数组啊，这边的话是一个数组，这边也也是一个数组啊。两边都是有都需要一个数度。

那么这边的话它调用的话，肯定调用这个函数。这个函数的话是SYSTN pin to host，对吧？好了，那么现在的话呢我们来。解一解这个这个题目，解期的思路很简单啊，我们来看一下。



![](img/ea3534616268f3d9d55059a31988b627_37.png)

啊，要反序列块的时候会优先调用we的，对吧？workakeing out，然后进行宫格过滤，然后调用这个方法。调完这个方法的话，它会把宫格过滤为空，过滤为空啊。



![](img/ea3534616268f3d9d55059a31988b627_39.png)

嗰你未讲。那么我们最终的一个。啊，过滤为空之后呢，它会做一个地值的传递，然后传到里面来。传到里面来之后呢，它在这个类结束的时候呢，它会调用这个收扣方法。然后这边的话判断它P是否在里面，是否在里面。

假如在里面的话，就调用调用这个扣又要发生案例，对吧？这里的话调用类的方调用方法的。那你调用方法的话，肯定是调用这个拼的对吧？只有这个了，然后在这里拼，然后。这个后实的话，这个后实假如可以空的话呢。

我们就可以。就可以做什么就可以这口水的话，肯定是这个传过来了对吧？这个D时的话表示的是什么？表示的一个参数参数啊，这边呢。它会把值传到里面来，就传到这里面来，这个值流外快就会传到这里面来了。

对吧然后这里肯这里是可空的啊，这里肯定是可空的。因为ARYGS的话就这里的值对吧？方法的话就是我们这个方法，这两这两个都是可以控的，这两个都是可以控的。所以的话呢我们让它执行拼就可以了。

然后这边再执行其它命令就可以了。好了。是特别简单的。那么现在的话呢，我们先来复制一下啊。

![](img/ea3534616268f3d9d55059a31988b627_41.png)

我们首先要拿到一个税列款。我们先在这边的话，新建一个DM一。

![](img/ea3534616268f3d9d55059a31988b627_43.png)

啊，选在个点目啊。好，那么我们拿到一些需要用到的地方啊，需要用到的话呢我们。这里啊我们先可以去掉了。好，我们可以先这样先来做一个。先来做什么？这些可以不用的啊，我们先把它去掉。这边的话我们。累啊。

新建一个类，16块一个类，16空类对吧？1分类之后呢，这里传递值，我们看一下这里传递的值是什么呀？这里传递的值，我们看一下。做联系方法，方法了快肯定是。偏犯法对吧？拼。

这里的话第二个的话常用的是一个什么？对吧ARGY大家看一下，这里的话是什么？他应该是一个数组，对吧？那这里传用的数度是127。0点。零点。点1对吧？0。0。14面有说吧。

hello呢这边呢我们需要做什么？我们看一下还需要做一个。复制L11给到1个11就可以了。好，让它序列化。或者这里的话，我这样让他看能不能执行，看能不能执行呢。对，这里的话是616块1块内。

然后传入两个值。第一的话是方法，方法的话呢，我们传入拼啊，这个方法会会来到这里，判断它是否在里面啊，看达这个字符算是否在里面。它肯定在里面的，所以的话呢才会执行这里的内容。其实内容这执行这里的内容的话。

大家看到这里的话常景的话它是一个拼拼方法。这里的话是参除，然后这边的话常用的话，它是一个数组啊，所以的话这边一定要用数组，你不用数字的话，这里执行不了了啊，没有值的话，这边都不会执行的。

他这里拼的话就是这里这样的方法。好的，那这边的话呢，我们让他看这里能不能执行了。我们下个端点，然后让他试一下。



![](img/ea3534616268f3d9d55059a31988b627_45.png)

这里的话我记得应该是他是一个。点六。DM点P须P好了，这边的话我们让它。

![](img/ea3534616268f3d9d55059a31988b627_47.png)

抓一下，这抓到了，让他实力化。好，这里大家看到pin然117。0。0啊过来了啊，我们看方法，方法的话是拼方法。这里的话单数的话它是。啊。127。0。0。1，这边的话已经复制了，大家看。

者完成了超位去哪里呀？超位去。超微去说什么？超微去。呃，这里就没了啊，这里就没了。然后它下面的话也下面这边的话，它也不会去执行了，然后呢插先来执行这个方法方法。然后这边的话掉进来个并并在里面的。

所以的话呢它会调到这里来。好。然后这里面大家看啊，这里面的话默方法的话是拼拼方法，对吧？然后这边的话最迟。值的话也过来了啊，17。001，然后这边的话会做一个拼草组。拼两次了，我们看一下页面。好。好。

呸好了，没了。这边的话就会输出。说出出来了啊，然后呢我们把这个把这段大码拿过来，然后在我们的。我们的这台主机上面啊，这台物理机上面然后做一个操作。



![](img/ea3534616268f3d9d55059a31988b627_49.png)

一二七点零零天点一。好，这里被拒绝了啊，这里甭用款了。

![](img/ea3534616268f3d9d55059a31988b627_51.png)

好，这里也不用管。

![](img/ea3534616268f3d9d55059a31988b627_53.png)

那么我们知道这里是可以正策运行的啊，对吧？好了，现在的话我们拿到这个序列框。拿到这个世界块，然后做什么操作啊？做一个系列化导作。那这个16块。先化这个类。里面的内容这边的话让他分享60。8小60。让他。

Encle。就可以了。对吧 in the angle。这边的话也可以给他一个。让他说说一下。好了，这样就很nice了。这边的话呢我们不需要再做什么断点之类的，我让它直接输取出来。



![](img/ea3534616268f3d9d55059a31988b627_55.png)

好了。对吧这里的话就是我们的要的内容。

![](img/ea3534616268f3d9d55059a31988b627_57.png)

那么呢我们。

![](img/ea3534616268f3d9d55059a31988b627_59.png)

先把将近开起来，然后呢在这边的话下个端点。那么我们这边他。好了。我让他来到昨夜。dmo5的主页in。点PHP这里的话应该是个A呀。A等于。先把后面去掉。好了，把这段传过来啊。



![](img/ea3534616268f3d9d55059a31988b627_61.png)

好了，这段弹过来之后呢，我们这边的话已经监清了。

![](img/ea3534616268f3d9d55059a31988b627_63.png)

才弄得我们。按这个ent按在这边来抓到这个包。

![](img/ea3534616268f3d9d55059a31988b627_65.png)

那这边我们看到这边已经A传过来了，值这里已经获取到了。那这边的话让差北侧64然那进行这个编码的解密。解密完之后呢，它这边的话会返序列化。好了，我们让它走走走。然后呢我们反序列化的时候。

假如他有这个魔术方法啊，有这个魔术方法的话，它首先会调用这个方法。好，这调换完之后，我们看一下。好，这里是170001，对吧？这边他会把。这边的话槽会过滤空，过滤完成后之后呢，才会调上这个函数。

我让它走走过来。这边的话我们看一下。好，这里的话是过滤空格的，过滤为空，这里返回置慧方127。0。1。好啦。然后这边的话，它会进行这个石叠花了，我们看一下。好了，这里有块同用池。两个值这边的话会变了。

这里的话就变了啊。然后它这边现在的话是。调这个方法了。采用这个方法，然后这边的话用这个SY。然后进行这个拼拼头作。好，这里的话再再拼啊。吓。这里还会再拼在再拼。嗯。



![](img/ea3534616268f3d9d55059a31988b627_67.png)

拼完了吗？我们看一下好，这里拼完了。

![](img/ea3534616268f3d9d55059a31988b627_69.png)

对吧那这里的话是没问题的，这里的话是可以政策运行的。那所以呢我们现在啊。我们现在的它我们现在需要的话，它是要读取这个flash，对吧？那呢我们可以看一下，这里面它是过滤风格的，就是我们。



![](img/ea3534616268f3d9d55059a31988b627_71.png)

![](img/ea3534616268f3d9d55059a31988b627_72.png)

我们来到demo这里，这里的话呢我们。

![](img/ea3534616268f3d9d55059a31988b627_74.png)

先来看看这些。好，这里的话是这个样子的啊。加二一一次。点0。0。1对吧？现在的话是这个样子啊，我让他来读取的话，我们可以加上这个。



![](img/ea3534616268f3d9d55059a31988b627_76.png)

啊管道啊。你弄呢做什么？在windows下呢可以用这个cha，然后读取多取flashHP对吧？那这里的话呢我建议啊大家一定要用这些。



![](img/ea3534616268f3d9d55059a31988b627_78.png)

用这些路线呢。用这些逻梯。你们想要读取的话，读取CDF里面的。那读取这里面的。Fger。把这个拿过来。



![](img/ea3534616268f3d9d55059a31988b627_80.png)

好。这里指定他的一个路径啊，让他来。

![](img/ea3534616268f3d9d55059a31988b627_82.png)

对。好，让他来读，我们看一下它这里能不能正常运行。

![](img/ea3534616268f3d9d55059a31988b627_84.png)

![](img/ea3534616268f3d9d55059a31988b627_85.png)

好，是没问题啊。大家看是可以专加运行的。对不对呀？那大家看到这里它有红格，有红格的话，我呢。

![](img/ea3534616268f3d9d55059a31988b627_87.png)

我们这边呢它是过滤空格的，大家看一下，这里的话，它首先会调用这个方法，方法里面呢它会调用这个再去调用这个方法。



![](img/ea3534616268f3d9d55059a31988b627_89.png)

那么呢这里的话他就把什么，他就把我们的。

![](img/ea3534616268f3d9d55059a31988b627_91.png)

红格去掉了，它就会变成这个样子。它就变成这个样子了，会导致我们语法不正确啊。那这边的话，你可以用一个这里因为它过滤空过滤的是空格，所以的话这边呢也可以用这个字表符。可用这表付啊。

这表夫我们看一下在这里能不能用啊。能不能打出来啊？这表这里打不打不出来啊。你在这里能不能打一个字表不出来，我们看一下。



![](img/ea3534616268f3d9d55059a31988b627_93.png)

好咩。

![](img/ea3534616268f3d9d55059a31988b627_95.png)

看这里能不能打一个这个这表，这里也打印不出来啊。

![](img/ea3534616268f3d9d55059a31988b627_97.png)

这里好像也打不出来。红哥的话，大家看一下红哥的话，他是。对吧红格的话，你看一下风格才这么点的那这表幅的话是t不见，贴不线就这么大的那所以的话这个这个应该是制表符，然后呢把它复制过来就可以了。



![](img/ea3534616268f3d9d55059a31988b627_99.png)

复得到这里来。哦，这里的啊。好啦。在这里应该是没问题的。假如你可以你也可以在这边来新建一个。新建一个文件进行测试啊。好，这边的话呢我们。把这个拿过来，把这看书拿过来。那这里的话呢，我们。调用一下就好了。

这里的话我们给他1个123。你让它这里它是空格呃，这里的话它是一个什么？它是一个制表符啊，我来看它过不过滤啊，对吧？就可以了。



![](img/ea3534616268f3d9d55059a31988b627_101.png)

这里的话应该是个。

![](img/ea3534616268f3d9d55059a31988b627_103.png)

ATR电配视频。好，这里有语法问题。

![](img/ea3534616268f3d9d55059a31988b627_105.png)

好，我们让他试一下。对吧。

![](img/ea3534616268f3d9d55059a31988b627_107.png)

啊，这边。这里好像过滤了。

![](img/ea3534616268f3d9d55059a31988b627_109.png)

我拿一下这个。

![](img/ea3534616268f3d9d55059a31988b627_111.png)

![](img/ea3534616268f3d9d55059a31988b627_112.png)

好，我们看下过不过滤啊，对吧？这里是没问题的，这里是不过滤的对吧？我们把这个拿回来就可以了。

![](img/ea3534616268f3d9d55059a31988b627_114.png)

那么。这里拿过来了拿过来复制一下就可可以了。那这边的话它应该是没问题的啊，应该是可以读取的。我先把。这个字表复后复制过来就可以了。哦。好。这里面就复制。嗯。好了。这里他还说我们语法有问题啊。好。

复制一下。啊，这里还是显示不了，那没问题，我们在这边试一下啊。我们在这边做一个。

![](img/ea3534616268f3d9d55059a31988b627_116.png)

吓。这边的话我们再来试一下。这边的话我们在点嘛。

![](img/ea3534616268f3d9d55059a31988b627_118.png)

你看看有没有。

![](img/ea3534616268f3d9d55059a31988b627_120.png)

好，大家看一下。这里已经备成60了，我们看一下原单没有没有拿到啊，就拿到了啊。现在的话这里拿到了，那呢我们把这一段拿过来就可以了。把把这段单能码拿过来。好。这边的话呢，我们把它放到。放到哪里。

放到inDS里面就可以了，把这段放过来就可以了。然后让它执行一下。那这边的话它就会抓到了。

![](img/ea3534616268f3d9d55059a31988b627_122.png)

好，找到之后，你们看一下，这边已经抓过来了，抓过来之后呢，我们让它走，它首先的话会掉到这里啊。hello呢，这里大家看一下。这里它是一个杠T啊，大家看到没有？它是个钢T，不是一个红格啊。

所以的话呢我们让他走。走了之后呢，它会调用这个函数wa的这个函数啊，然后呢才判断它它会过滤里面的红格，然后转为空。这里因为呢它是一个自表符，所以的话呢这里的话不会转的。好，对吧？好。

那这里完这里已经完成了，完成之后呢，它是做什么构造函数了，对吧？构造函数pin啊，里面这里的方法方法是pin啊，它在里面。所以的话呢执行这里的操作。这里的话是调用一个方法的，然后常入常入的值。

它是一个数组。好，让他走，这里的话肯定是拼了，对吧？方法的话是拼拼方法的话，就这个方法。然后呢值的话呢是这里个值传过来让他走，对吧？这里的话他就会做什么。啊，这里有个片 c跟啊稍会执行后面的代码。

执行后面的代码。吓。他，这里在执行。好，这就完了，他就会来到。这接完了啊，这里也能走走出这个。走出这个方法了。好了，这里就没了啊。



![](img/ea3534616268f3d9d55059a31988b627_124.png)

好了，这边的话已经可以看到了，你应该有了啊，对吧？

![](img/ea3534616268f3d9d55059a31988b627_126.png)

那这个的话就是呃反序列化的这个。函数啊。的一些题目啊。

![](img/ea3534616268f3d9d55059a31988b627_128.png)

好了，那这道题的话就这么来解啊就这么来解。好了。这里的话给个处给大家啊。

![](img/ea3534616268f3d9d55059a31988b627_130.png)

![](img/ea3534616268f3d9d55059a31988b627_131.png)

这里的截球方法。

![](img/ea3534616268f3d9d55059a31988b627_133.png)

好了，那么我们这节课就先到这里啊。下节课的话给大家讲这个函数，还有一些小bug。那么我们下节课再见吧，拜拜。



![](img/ea3534616268f3d9d55059a31988b627_135.png)