# 2024最新版网络安全秋招面试短期突击面试题【100道】我会出手带你一周上岸！（网络安全、渗透测试、web安全、安全运营、内网安全、等保测评、CTF等） - P54：建立通信隧道 - CTF入门教学 - BV1bcsTeXEwR

hello，大家好，我是黑客大白。那接下来我们依旧是看一道面试题。这道面试题呢也是同样出自于某公司高级渗透工程师的一个面试题。面试官呢提问具体如何搭建这个通信隧道。其实针对于这样的一类的题目来讲。

都是面试官对于这个应聘者呢内网渗透知识的一个。具体的技能的考察。其实相对于这个呃高级渗透工程师和红队等等啊，这一类的高薪岗位而言，内网渗透已经是这个岗位任职必须的一个技能。

其实像这种搭建内网隧道这一类的呃这个技术的话，其实是这个岗位非常基础的一个技能的啊。所以说如果想要挑战高新的这个小伙伴，一定要把这个内网方面呢多花一些功夫去钻研学习一下。好。

那么关于这个滤网隧道的介绍呢，我们前面在讲解这个相应的呃面试题的时候，实际上也给大家去讲到过。那因此呢这里的话我们就不再浪费大家的一些时间。其实我就简单的去点一下啊。

那内网隧道呢实际上就是攻击者呢在没有办法直接入侵到这个目标靶机的。这种情况下，通过搭建一些专属的这个内网隧道啊，是通过这个什么断路转发呀，内网穿透等等这种方式来进一步的入侵内网。好。

首先的话我们也是一起来学习一下这个渗透攻击的一个流程。在通常情况下呢，黑客在确定这个攻击的目标之后啊，会围绕着这个目标信息呢。进行信息收集啊，我们业内呢也俗称叫做打点。

当这个黑客呢收集到足够的这个相应的信息之后啊，比如说对方的这个操作系统。它的这个相应的中间件啊等等等等啊，它是由什么框架搭建的，对不对啊，这些信息之后呢。

它就会根据对方得到的这些关键信息呢选择对应的攻击方案。然后。对对方尝试发起这个入侵。那一旦入侵攻击成功，就能够对对方的把机或者是系统呢取得一个初步的控制。那么取得这个初步控制之后。

接下来它就会进行权限提升。啊，就是我们。一般情况下都是通过对方的某一个资产或者是某一个网站，然后去入侵对方的系统。在这个情况下呢，你的相应的权限是比较低的。因此，我们要还要尝试进行权限提升。

权限提升完了之后，还要做权限维持。完了之后彻底掌握这个系统或者是这台机器之后呢。还要对这个内网下面。啊，也就是当前这台机器呢它所处的这个内网环境呢进行进一步的信息收集。收集到足够的资产和信息之后。

再对整个内网的其他主机呢发现发起这个攻击啊，这一步过程也叫做横向移动。好，然后横向移动完了之后，拿下另一台主机之后呢，OK再次进行这个流程。好，这个流程的话，实际上在内网环境下面是呃用的比较多的啊。好。

最后的话呢就是整个过程的话是完成攻击。😊，那么在这个过程中。好，我们知道了这个相应的攻击流程之后呢，我们接下来看一下为什么要搭建这个通行隧道。其实，当攻击者对靶机建立这个初步的控制以后。

就可以把这个把机呢作为从外网进入内网的一个根据地。那么就可以在这台机器上面建立一些隧道啊，也就是我们所说的利用这个跳板机去实现对内网的入侵。那什么是端口转发呢？

端口转发实际上呢我我们也大部分也叫它叫做这个隧道啊。也就是说转发一个网络端口中的一个数据，将这个端口中的数据呢从一个节点转发到另一个节点。啊，也就是比如说啊我们呃当前的这个系统呢，它开放了一个端口。

那么我们就把它当前这个端口利用起来，把它里面的一些数据呢。把它转发出去。啊，转发到另一个网络节点上去啊，这个就叫做端口转发。那么最常见的这个端口转发工具，实际上最经典的也是这个LCX。

那前面实际上我们给大家介绍这个内网隧道的时候，也给大家。假到过这款工具啊，这款工具呢它是基于这个socket的套接制，实现这个端口转发的。那么它现在呢已经具有windows和linux。

两个版本的这样的一个工具啊，当然具体的这个端口转换工具其实远远不止这一款。那么最经典的呢，其实还是指呃就是这一款了。我们在这个讲解过程中呢，就以这款工具作为这个教学来给大家去讲解。好。

接下来我们来具体看一下这个LSLCX呢，它的这个呃具体的操作是怎么样的。好，大家可以看到这两张图解。首先呢我们可以看到这里呢呃有一台攻击机，这台攻击机的话呢，它去直接打下这个内网中机械的过程中呢。

是中间间隔的有一道防火墙。那如果说我们使用这个LCX去对对方发起这个主动连接的话，这个过程实际上叫做正向连接啊，就是我们公积机主动向。目标发起一个连接。那么在这个过程中呢，公积机是主动向对方发起连接的。

因此它这个过程叫做正向连接。那在这个过程中，哎，我们公积机控制了这一台机器之后，发现呢对方还存在一个不同的网段，也就是存在一个内网啊。那么我们的呃内网环境下面。

它大家可以看到他的这个IP地址的网段其实是不一样的那也就代表着我们这里直接去连接这个相应的网段的话，他们的网络是不通的。因此我们在这个过程中就要把它的这个隧道给打通啊。

让他这个192168这个网段呢能够去具备访问这个10。0。0这个网段的这样一个呃这个能力啊，也就是说让他们把这个通信打通了之后，它才能够去具体的对这个靶机。才能实现一个横向的移动。好。

具体的过程呢就是使用这个LCX我们需要把这个LCX这款工具呢上传到这个跳板机，也就是我们拿下权限的这台机器上面。然后呢，执行这样一条命令。LCX杠te，然后将这个192168。9这样一个。

也就是我们的目标机器啊，这个也就是我们在内网下的实现横向移动的。这个把机。内网下的另一台机器。将这台把机的3389端口呢转发到。这个4个8这样一个端口。好，那么转发完了之后呃，由于这个跳板机呢。

它身上有两张网卡，也就是说这个跳板机实际上是可以和这个公积金呢互相通信的，对不对？因为他们这2个IP地址是一样的。而这个跳板机呢，它有两张网卡，它第二张网卡呢是10。0。0。5。好。

这张网卡和这个内网中的这张网卡呢也能实现通信。因此呢这个跳板机上执行这个相应的端口转发的话，就可以把这个机器上面的。这个3389的端口的流量转发到这个4个8，也就是他自己的这个4个8这个端口上面去。

转发到这个4个8端口上面去的时候，由于这个公击机呢可以直接对这个跳板机发起这个连接。因此我们去使用公击机连接这个跳板机的4个8端口，实际上也就相当于去连接了这个内网下面的这个靶机的端口。

因此这个的话就是LCX呢发起正向连接的一个过程。那么这个使用场景的话呢，这个相应的防火墙要对于我们这个转发的这个相应的4个8这个端口，它是允许通信的啊，在这个过程中才行啊。好，这个是一个正向连接的过程。

那么我们再来看一下LCX的一个反向连接。LCX的一个反向连接呢，我们刚刚其实也都看到啊，使用场景呢也都是一样的。那么在这个过程中呢呃。反向连接呢跳板机。也是就是在跳板机上面，也是需要这个公击机呢。

在跳板机上面上传一个这个LCX的这一款工具。那么在LCI这个跳本机上面执行这样一条命令。杠。S。love然后把这个1921680点。啊，也就是把这个10。0。0。

9的3389这个端口转发到这个1921680。100这个。4个6这样一个端口上。也就是说啊我们刚刚的正向连接实际上是什么呢？就是把这个靶机里面的3389端口呢转发到这个跳板机上面。然后呢。

公击机再主动连接它啊，那个是一个正向连接。那现在是反向连接，反向连接是什么呢？就是在跳本机上面直接执行这样一个命令，把这个靶机的3389端口呢。直接哎转发到这里来啊，转发到他的这个。4个6这个端口上。

然后呢我们在公击器上面再使用这个LCX呢杠listen去监听是吗？监听这个4个6的端口，然后再实行一次二次转发，再转发到自己的这个4个8的端口。因此这样在进行转发之后。

我们直接可以在本机呢使用远程桌面连接，输入127。0。0。1，也就是输入本地的这4个8端口，就可以直接对对方呢发起一个远程控制啊，这个就是一个反向连接的过程，明白吧？那么在这个过程中呢。

我们公积机去访问我们自己本机上面的这4个8端口，实际上就相当于访问呢。这个呃经过跳板机。进行转发之后的这个4个6端口。那这4个6端口呢？又其实又是这个跳板机在这个目标机上面转发过来的啊。

这是一个反向连接的一个过程。好，那么关于更多的这个相应的面试题呢，呃这个大白这边其实也给大家做了更多的整理归纳。欢迎有需要的小伙伴呢。私信啊在评论区私信留言，我们一起学习进步，谢谢大家。

