# 2024网络安全系统教程！清华大佬花159小时讲完的网络安全系统课！别再盲目自学了，学完即可就业！零基础入门网络安全！（渗透测试／漏洞挖掘／CTF／黑客技术） - P44：31.NinjaCopy.mp4 - 教网络安全的红客 - BV1ft421A7Nj

啊呃，第二个的话就是这一个。呃，ne copypy这个的话就是其主要的话就是介绍一下这一个工具的一个使用。就这个的话它是一个抛的一个脚本。就这个脚本的话。

我们可以直接通过它来去进行一个呃获取我们想要的这样子的三个文件。嗯。然后的话他没有去调用我们这边的1个VSVVSSR的一个服务啊，所以的话他没有产生这样子的一个日志文件，也是要注意的。

然后具体的一个使用的话，就是如果说你是直接在呃你直接把它的一个脚本，就是放到放到我们的这样子的一个呃，就上传到我们的一个目标系统上面的话，我们通过这样子的一个方法，就是在power share当中。

我们首先import model，就是导入这样子的一个文件，就这边的一个import model的话，就是导入模块嘛，就是把我们这里的一个power share里面的这样子的一些功能，把它导入到。

我们的一个呃po share当中，然后的话我们就能够去直接的去调用这里的一个po share脚脚本当中所声明的这样子的一些函数，以及它的一个方法。主要的话就是用到这个invo呃那就 copypy。

然后的话它的一个使用方法的话就是干p指定我们要去呃要去获取的这样子的一个文件名啊，文件路径。在这边的话呃，主要的话就是这三个文件路径嘛，就是sm，还有现场，还有N。这个NTDS等DIT对吧？

然后呃干local destination的话就是本地，就指指定我们这边copy的这样子的一个文文件的一个路径，把它放到哪一个地方，以及以什么样子的一个名字。对。这是一个。然后第二个的话就是呃。

我们其实常用的话就是在这边的话。我们一般对吧？一般的话我们得到一个需的话，就是比如说在CS上面得到了这样子的一个选。那么在CS上面的话，我们怎么去进行相应的这样子的一个。

就是说去调用这样子的一个power share的一个脚本呢。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_1.png)

啊，就CS里面的话，它有集成，它有自带的这样子的一个功能啊，所大家可以通过help来去查看。他的。呃，一些功能对吧？然后的话你就能够去发现有这样子的po share的一个命令。

主要的话是在power share以及power share import这边的一个p share的话，其实就是呃在power sharepower share下面去执行命令嘛。

然后这里的一个抛 inport的话，就是呃导入抛的一个脚本。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_3.png)

嗯，也就是说我们可以通过这边CS当中，它内置的这样子的一个线port，来把我们本地的这样子的一个呃脚本。做做一个导入。导入之后的话，我们就能够在直接在CS当中，我们通过p share。这样子的一个命令。

来去执行这边的一个脚本的这样子的一个方法来去进行相应的一个操作。哦，这边的话。给大家演示一下，好吧。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_5.png)

Yeah。这边的话呃，文件路径的话是在这里，然后呃。我们通过抛絮。啊，我看一下。那个。我个猪卡。我找个 u控。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_7.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_8.png)

呃，这个吧，这个是我另外一个环境的一个预控。嗯。你方。这个的话我们可以通过pa就。Inport。来去导入我们本地的。我这边本地的话就是呃这一个呃脚本抛弃脚本的一个路径的话，就是这个嘛。嗯，那我们。

回车执行之后的话，他就会把我们这一个脚本导入进去。导入进去之后的话，我们可以通过p share。这一个命令。来去执行这个脚本的一个方法。我们以这一个文件呃。直接以这个吧。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_10.png)

第48元。这边的话，我先把这个文件删掉。可看到在这边的话已经没有这1个NTDS的一个文件了，对吧？然后我们在这边的话，我们执行。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_12.png)

执行之后的话呃，在这边他执行这个脚本的话，可能需要等的，就是要。需要需要一定的一个时间。哦。搞错了。我这边的这个御控的话不是这个机器啊。是我另外的一个。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_14.png)

环境啊。所以的话，我在这边执行的话。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_16.png)

呃，在这个这边的一个机器里面的话是看不到的。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_18.png)

Yeah。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_20.png)

🤧嗯。呃，是在我这边的一个机器啊。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_22.png)

先把这一个。NTDS给删掉，这个应该其实是刚刚生成的。好，我们再执行。下来执行一遍。可以看到对吧？在这边的话就已经生成了这重新生成了一个新的1个NTDS点DIT的一个文件，就同理。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_24.png)

同理其他的这样子的一个文件的话，我们也可以通过这个脚本来去进行一个导出。就是呃使用的一个命令的话，就是通过这样子的一个命令。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_26.png)

其实在这边的话主要就是介绍这个p尔的呃直接在CS当中，我们可以直接去加载我们的一个抛的一个脚本。然后的话在CSCS当中通过抛 share的一个命令来去进行一个执行。然后同理其实我们也可以。

因为在这边的话，我们前面在这的话是我们把这个脚本把那个上传到本地，对吧？然后的话在本地去进行一个执行下载。哦呃在这边的话，我们第二种的话就是通过这样子的一个呃。

CS就CS里面它的这样子的一个加载抛 share的一个方法来去行一个执行。啊，其实我们也可以通过就是远程加载的一个方法。远程加载的话就是。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_28.png)

比如说我们可以直接通过这样子的一个命令。来去调用我远程的一个脚本嗯。就是这个。然后这边的话要去。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_30.png)

呃，我们先来看一下效果吧，然后我再给大家。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_32.png)

大概解释一下他的一个就我这边的一个脚本，他的一个意思。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_34.png)

咁样我自接带街。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_36.png)

我这边的话已经有一个执行了的。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_38.png)

哎。我自个冲。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_40.png)

这边话我在这里执行这一个脚本。啊，我这边的话。没有起伏啊。然后呃其实如果大家就是在用抛弃脚本的时候，碰到这样子的一个报错，你要知道他是为什么。就比如说在这边，他报了这样子的一个报错是donload。

它无法就是无法连接到远程服务器嘛，对吧？那么这个时候你就要去确定你要去确定你的这一个链接，它是就是你这边的一个脚本的一个路径。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_42.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_43.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_44.png)

这个链接他是否能够去访问到。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_46.png)

啊呃，因为我这边的话是放在。我的这个VPS上面。我这边的话没有提这个服务啊。我这边的话是把脚本放在了。呃，这里啊对吧，然后我这边的话通过pathon。起1个HTB的一个s位。签好之后的话。我们再去执行。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_48.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_49.png)

然后在这的话我们可以看到我们这边执行之后的话，发现有了有这个IP对吧？来请求了我们这边的一个脚本。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_51.png)

嗯。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_53.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_54.png)

Okay。这个等他执询完。可以看到我这边的话执行完之后的话，就呃在这边指定的一个C盘的一个目录下面的话，就生成了这样子的一个文件，对吧？



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_56.png)

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_57.png)

然后在这边的话，我们回过头来看一下这一个脚本它的一个。呃。这一个脚本它是怎么。呃，实现的他那个。作用。然后其实在这里的话呃，就前面这里的话，其实我们前面已经有介绍。

就是呃po share的一个基本的一个使用，就是通过这样子的一个net web client的一个对象，它的一个donorstr的一个方法来去下载，来去加载我们这边远程VPS上面的这一个po的一个脚本。

把它加载到把它加载到内存当中。然后加载到内存当中的话，我们直接用这样子的一个方法来去啊。用这嘅愿宝琴。呃，你就 copypy的一个方法来去。把我们这边的这个上文件。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_59.png)

把它给就是copy到我们的一个指定的一个目录下面。然后同理的话，同理其他的一个文件也是一样的。

![](img/68c5bd0194157e0abf262e3d8b8aa5c1_61.png)

然在的话只需要改一下你的一个路径名就ok了。还有其他的。这边的话我就不一一的演示了，这边的话就是通过远程加载的一个方法。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_63.png)

就其实这边实际的话就是呃就三种不同的一个方法。但的话使用的话都是同就是它是一个加载的一个不同嘛。呃使用的话都是同样的这样子的一个脚本。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_65.png)

大家呃，对上面的一个内容有什么问题没有？嗯。大家有没有什么疑问？应该能理解吧。能理解得扣一有问题的扣2。ok。啊，就两位同学吗？是啊。



![](img/68c5bd0194157e0abf262e3d8b8aa5c1_67.png)

好的，应该都能理解。